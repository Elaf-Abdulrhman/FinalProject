{% for post in posts %}
<div class="card mb-3 shadow-sm p-3 position-relative">
    <a href="{% url 'posts:post_details' post.id %}" class="stretched-link text-decoration-none text-dark"></a>

    <div class="d-flex justify-content-between align-items-start">
        <div class="d-flex align-items-center">
            <img src="#" alt="Profile" class="rounded-circle me-2" width="40" height="40">
            <div>
                <strong>
                    {% if post.user.athlete %}
                        {{ post.user.first_name }}
                    {% elif post.user.club %}
                        {{ post.user.club.clubName }} <i class="bi bi-patch-check-fill"></i>
                    {% else %}
                        {{ post.user.username }}
                    {% endif %}
                </strong><br>
                <small class="text-muted">@{{ post.user.username }}</small>
            </div>
        </div>

        <div class="d-flex gap-3 z-1">
            <i class="bi bi-bookmark" style="font-size: 1.2rem; cursor: pointer;"></i>

            <form action="{% url 'posts:like_post' post.id %}" method="POST" class="d-inline">
                {% csrf_token %}
                {% if post.is_liked %}
                    <button type="submit" class="btn btn-sm text-danger border-0 bg-transparent p-0">
                        <i class="bi bi-heart-fill" style="font-size: 1.3rem;"></i> {{ post.total_likes }}
                    </button>
                {% else %}
                    <button type="submit" class="btn btn-sm text-muted border-0 bg-transparent p-0">
                        <i class="bi bi-heart" style="font-size: 1.3rem;"></i> {{ post.total_likes }}
                    </button>
                {% endif %}
            </form>
        </div>
    </div>

    <div class="mt-3 z-1">
        <p>&nbsp;&nbsp;&nbsp;{{ post.content|truncatewords:25 }}</p>

        {% if post.photo %}
            <div class="mt-2">
                <img src="{{ post.photo.url }}" alt="Post Media" class="img-fluid rounded" style="max-height: 200px; width: auto; display: block; margin: 0 auto;">
            </div>
        {% endif %}
    </div>

    <div class="text-end mt-3">
        {{ post.comments.count }} <i class="bi bi-chat" style="font-size: 1.3rem;"></i>
    </div>
</div>
{% endfor %}
